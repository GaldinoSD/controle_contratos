{% extends "base.html" %}
{% block content %}

<!-- ======================================================= -->
<!-- ================= HEADER COMPACTO PREMIUM ============== -->
<!-- ======================================================= -->
<section class="mb-6 relative">

  <div class="rounded-xl p-5 bg-slate-900/80 shadow-lg border border-slate-800
              backdrop-blur-xl overflow-hidden relative">

    <!-- Glows -->
    <div class="absolute -top-8 -left-8 w-32 h-32 bg-blue-600/20 blur-2xl rounded-full"></div>
    <div class="absolute bottom-0 right-0 w-32 h-32 bg-cyan-500/10 blur-2xl rounded-full"></div>

    <div class="relative flex items-center justify-between">

      <!-- ESQUERDA -->
      <div class="flex items-center gap-4">
        <div class="p-3 bg-blue-600/10 rounded-xl border border-blue-500/20">
          <i class="fa-solid fa-folder-open text-blue-400 text-2xl"></i>
        </div>

        <div>
          <h1 class="text-2xl font-bold text-white tracking-tight">
            Todos os Contratos
          </h1>
          <p class="text-slate-400 text-xs mt-1">
            Lista completa de contratos cadastrados
          </p>
        </div>
      </div>

      <!-- BOTÃO NOVO -->
      <button onclick="abrirModalContrato()"
        class="px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow
               flex items-center gap-2 text-sm transition">
        <i class="fa-solid fa-file-circle-plus"></i> Novo Contrato
      </button>

    </div>

  </div>

</section>



<!-- ======================================================= -->
<!-- ================== TABELA DE CONTRATOS ================= -->
<!-- ======================================================= -->
<div class="bg-slate-900/60 backdrop-blur-md p-4 rounded-xl shadow-xl border border-slate-800">

  <table class="w-full text-sm">
    <thead class="bg-slate-800/70 text-slate-300 text-[11px] uppercase tracking-wide border-b border-slate-700">
      <tr>
        <th class="p-3 text-left">Empresa</th>
        <th class="p-3 text-left">CNPJ</th>
        <th class="p-3 text-left">Vigência</th>
        <th class="p-3 text-center">Ações</th>
      </tr>
    </thead>

    <tbody class="text-slate-200">
      {% for c in contracts %}
      <tr class="border-b border-slate-800 hover:bg-slate-800/40 transition">

        <!-- EMPRESA -->
        <td class="p-3 flex items-center gap-3 font-medium">

          <!-- Avatar letra -->
          <div class="w-9 h-9 bg-blue-600/20 text-blue-400 rounded-lg flex items-center justify-center 
                      font-bold border border-blue-500/20 text-sm">
            {{ c.company.name[0] }}
          </div>

          {{ c.company.name }}
        </td>

        <!-- CNPJ -->
        <td class="p-3 text-slate-400 text-sm">{{ c.company.cnpj }}</td>

        <!-- VIGÊNCIA -->
        <td class="p-3 text-slate-300 text-sm">
          <span class="font-medium">{{ c.start_date }}</span>
          <span class="text-slate-500 px-1">→</span>
          <span class="font-medium">{{ c.end_date }}</span>
        </td>

        <!-- AÇÕES -->
        <td class="p-3 text-center">
          <a href="/contract/{{ c.id }}"
            class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded-lg shadow 
                   flex items-center justify-center gap-2 mx-auto w-fit transition">
            <i class="fa-solid fa-arrow-up-right-from-square"></i> Abrir
          </a>
        </td>

      </tr>
      {% endfor %}
    </tbody>

  </table>
</div>



<!-- ======================================================= -->
<!-- ==================== MODAL NOVO CONTRATO =============== -->
<!-- ======================================================= -->
<div id="modalContrato" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50">

  <div class="bg-slate-900/95 border border-slate-700 rounded-xl shadow-2xl p-7 
              w-full max-w-xl relative animate-fadeIn">

    <!-- Fechar -->
    <button onclick="fecharModalContrato()"
      class="absolute top-3 right-4 text-slate-400 hover:text-red-400 text-xl">
      &times;
    </button>

    <h2 class="text-xl font-bold text-white mb-5 flex items-center gap-2">
      <i class="fa-solid fa-file-circle-plus text-blue-400"></i>
      Novo Contrato
    </h2>

    <form action="/contracts/new" method="POST" class="grid grid-cols-1 md:grid-cols-2 gap-4 text-slate-200">

      <div class="md:col-span-2">
        <label class="text-xs font-medium">Empresa</label>
        <input name="company" class="w-full bg-slate-800 border border-slate-700 p-3 rounded-lg text-sm" required>
      </div>

      <div class="md:col-span-2">
        <label class="text-xs font-medium">CNPJ</label>
        <input name="cnpj" class="w-full bg-slate-800 border border-slate-700 p-3 rounded-lg text-sm" required>
      </div>

      <div class="md:col-span-2">
        <label class="text-xs font-medium">Descrição</label>
        <textarea name="desc" rows="3" class="w-full bg-slate-800 border border-slate-700 p-3 rounded-lg text-sm"></textarea>
      </div>

      <div>
        <label class="text-xs font-medium">Início</label>
        <input type="date" name="start" class="w-full bg-slate-800 border border-slate-700 p-3 rounded-lg text-sm" required>
      </div>

      <div>
        <label class="text-xs font-medium">Fim</label>
        <input type="date" name="end" class="w-full bg-slate-800 border border-slate-700 p-3 rounded-lg text-sm" required>
      </div>

      <div class="md:col-span-2 flex justify-end gap-3 mt-3">
        <button type="button" onclick="fecharModalContrato()"
          class="px-5 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-600 
                 rounded-lg text-xs transition">
          Cancelar
        </button>

        <button class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg 
                       shadow text-xs font-semibold transition">
          Salvar
        </button>
      </div>

    </form>

  </div>
</div>

<script>
  function abrirModalContrato() {
    modalContrato.classList.remove("hidden");
  }

  function fecharModalContrato() {
    modalContrato.classList.add("hidden");
  }
</script>

<style>
@keyframes fadeIn {
  from { opacity: 0; transform: scale(.95); }
  to   { opacity: 1; transform: scale(1); }
}
.animate-fadeIn { animation: fadeIn .2s ease-out; }
</style>

{% endblock %}
